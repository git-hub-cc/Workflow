<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的佣金 - 穗源保险公估一体化业务管理平台</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="app-container">
    <aside class="sidebar">
        <div class="sidebar-header">穗源保险公估</div>
        <ul class="sidebar-nav">
            <li class="sidebar-nav-item"><a href="surveyor_task_list.html">我的任务</a></li>
            <li class="sidebar-nav-item"><a href="surveyor_case_history.html">历史案件</a></li>
            <li class="sidebar-nav-item active"><a href="surveyor_commission.html">我的佣金</a></li>
            <li class="sidebar-nav-item"><a href="surveyor_withdrawal_history.html">提现记录</a></li>
        </ul>
    </aside>

    <div class="main-wrapper">
        <header class="header">
            <div class="header-left">
                <button id="hamburger-btn" class="hamburger-btn">☰</button>
            </div>
            <div class="user-profile">
                <div class="avatar" style="background-color: #409EFF;">陈</div>
                <span>陈浩 (查勘员)</span>
            </div>
        </header>

        <main class="main-content">
            <h1 class="page-title">我的佣金</h1>

            <div class="kpi-card-container">
                <div class="card kpi-card green">
                    <div class="value">6,850<span class="unit">元</span></div>
                    <div class="label">本月预估收入</div>
                </div>
                <div class="card kpi-card blue">
                    <div class="value">3,500<span class="unit">元</span></div>
                    <div class="label">可提现余额</div>
                </div>
                <div class="card kpi-card orange">
                    <div class="value">3,350<span class="unit">元</span></div>
                    <div class="label">待结算金额</div>
                </div>
            </div>

            <div class="card">
                <div class="filter-bar">
                    <div class="filter-item">
                        <label>完成日期:</label>
                        <input type="date">
                        <span>-</span>
                        <input type="date">
                    </div>
                    <div class="filter-item">
                        <label>案件号:</label>
                        <input type="text" placeholder="输入案件编号...">
                    </div>
                    <div class="filter-item">
                        <label>状态:</label>
                        <select>
                            <option>全部</option>
                            <option>可提现</option>
                            <option>待结算</option>
                        </select>
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-primary">查询</button>
                        <button class="btn btn-secondary">重置</button>
                    </div>
                </div>

                <div class="card-header">
                    <span>我的任务佣金</span>
                    <div class="header-actions">
                        <span class="selection-summary">
                            已勾选: <strong id="selected-total">0.00 元</strong>
                        </span>
                        <button id="withdraw-btn" class="btn btn-primary">申请提现</button>
                    </div>
                </div>
                <div class="table-responsive-wrapper">
                    <table>
                        <thead>
                        <tr>
                            <th style="width: 40px; text-align: center;"><input type="checkbox" id="select-all"></th>
                            <th>案件编号</th>
                            <th>任务类型</th>
                            <th>完成时间</th>
                            <th>佣金状态</th>
                            <th class="text-right">佣金金额 (元)</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td style="text-align: center;"><input type="checkbox" class="task-checkbox" data-amount="180.00"></td>
                            <td>SY-20240520-001</td>
                            <td>查勘+定损 (超时扣罚)</td>
                            <td>2024-05-20</td>
                            <td><span class="status-tag status-success">可提现</span></td>
                            <td class="text-right text-bold">180.00</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;"><input type="checkbox" class="task-checkbox" data-amount="450.00"></td>
                            <td>SY-20240515-011</td>
                            <td>查勘+定损 (KPI扣罚)</td>
                            <td>2024-05-16</td>
                            <td><span class="status-tag status-success">可提现</span></td>
                            <td class="text-right text-bold">450.00</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;"><input type="checkbox" class="task-checkbox" data-amount="2870.00"></td>
                            <td>SY-20240512-007</td>
                            <td>财险大案（定损）</td>
                            <td>2024-05-12</td>
                            <td><span class="status-tag status-success">可提现</span></td>
                            <td class="text-right text-bold">2,870.00</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;"><input type="checkbox" disabled></td>
                            <td>SY-20240522-008</td>
                            <td>现场查勘</td>
                            <td>2024-05-22</td>
                            <td><span class="status-tag status-warning">待结算</span></td>
                            <td class="text-right">120.00</td>
                        </tr>
                        <tr>
                            <td style="text-align: center;"><input type="checkbox" disabled></td>
                            <td>SY-20240523-010</td>
                            <td>人伤查勘</td>
                            <td>2024-05-23</td>
                            <td><span class="status-tag status-warning">待结算</span></td>
                            <td class="text-right">3,230.00</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="card-footer">
                    <nav class="pagination">
                        <ul>
                            <li class="disabled"><a href="#">&laquo;</a></li>
                            <li class="active"><a href="#">1</a></li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">&raquo;</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </main>
    </div>
</div>
<script src="demo_helper.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const selectAllCheckbox = document.getElementById('select-all');
        const taskCheckboxes = document.querySelectorAll('.task-checkbox:not([disabled])');
        const selectedTotalEl = document.getElementById('selected-total');
        const withdrawBtn = document.getElementById('withdraw-btn');

        function updateTotal() {
            let total = 0;
            taskCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    total += parseFloat(checkbox.dataset.amount);
                }
            });
            selectedTotalEl.textContent = total.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' 元';
        }

        selectAllCheckbox.addEventListener('change', function() {
            taskCheckboxes.forEach(checkbox => {
                checkbox.checked = this.checked;
            });
            updateTotal();
        });

        taskCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                selectAllCheckbox.checked = Array.from(taskCheckboxes).every(cb => cb.checked);
                updateTotal();
            });
        });

        withdrawBtn.addEventListener('click', function() {
            const totalAmountText = selectedTotalEl.textContent;
            const totalAmount = parseFloat(totalAmountText.replace(/,/g, '').trim());

            if (totalAmount <= 0) {
                showModal('操作提示', '请至少选择一个可提现的任务。', 'warning');
                return;
            }
            showModal('提现申请确认', `您正在申请提现 <strong>${totalAmountText}</strong>，确认提交吗？`, 'info');
        });
    });
</script>
</body>
</html>