<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>车险案件录入 - 穗源保险公估一体化业务管理平台</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* 页面专属样式 */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2列表格布局 */
            gap: 20px 30px;
        }
        .form-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .form-item.col-span-2 {
            grid-column: span 2;
        }
        .form-item > label {
            color: var(--text-color-regular);
            font-weight: 500;
            font-size: 13px;
        }
        .form-item input, .form-item select, .form-item textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color-base);
            border-radius: var(--border-radius-base);
            font-size: 14px;
            transition: border-color 0.2s;
            box-sizing: border-box;
        }
        .form-item input:focus, .form-item select:focus, .form-item textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        .form-item input[disabled] {
            background-color: #F5F7FA;
            color: #C0C4CC;
            cursor: not-allowed;
        }
        .form-item textarea {
            min-height: 60px;
            resize: vertical;
        }
        .form-actions {
            grid-column: 1 / -1;
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid var(--border-color-light);
            margin-top: 20px;
        }
        .btn {
            padding: 10px 25px;
            border-radius: var(--border-radius-base);
            border: 1px solid transparent;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            margin: 0 8px;
        }
        .btn-primary {
            background-color: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
        }
        .btn-primary:hover { opacity: 0.8; }
        .btn-secondary {
            background-color: #fff;
            color: var(--text-color-regular);
            border-color: var(--border-color-base);
        }
        .btn-secondary:hover { color: var(--primary-color); border-color: var(--primary-color); }
        .input-group { display: flex; gap: 10px; }
        .input-group .city-select { flex: 1; }
        .input-group .address-input { flex: 2; }

        /* --- 新增样式: 用于输入框+按钮组合 --- */
        .input-with-button {
            display: flex;
        }
        .input-with-button input {
            flex-grow: 1;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            border-right: none;
        }
        .input-with-button button {
            flex-shrink: 0; /* 防止按钮被压缩 */
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            padding: 8px 15px; /* 调整按钮内边距以匹配输入框高度 */
            margin: 0;
        }
    </style>
</head>
<body>
<div class="app-container">
    <!-- 侧边导航栏 -->
    <aside class="sidebar">
        <div class="sidebar-header">穗源保险公估</div>
        <ul class="sidebar-nav">
            <li class="sidebar-nav-item"><a href="dispatcher_dispatch_center.html">派单中心</a></li>
            <li class="sidebar-nav-item active"><a href="dispatcher_case_entry.html">案件录入</a></li>
            <li class="sidebar-nav-item"><a href="dispatcher_task_query.html">任务查询</a></li>
            <li class="sidebar-nav-item"><a href="dispatcher_schedule_management.html">排班管理</a></li>
        </ul>
    </aside>

    <!-- 主内容区 -->
    <div class="main-wrapper">
        <!-- 顶部栏 -->
        <header class="header">
            <div class="user-profile">
                <div class="avatar" style="background-color: #E6A23C;">王</div>
                <span>王芳 (调度员)</span>
            </div>
        </header>

        <!-- 页面内容 -->
        <main class="main-content">
            <h1 class="page-title">车险案件录入</h1>

            <div class="card">
                <div class="card-header">案件委托信息</div>
                <form class="form-grid">
                    <!-- Row 1 -->
                    <div class="form-item col-span-2">
                        <label for="case-no">案件号 / 报案号</label>
                        <div class="input-with-button">
                            <input type="text" id="case-no" placeholder="输入保险公司案件号后点击获取">
                            <button type="button" id="fetch-case-data-btn" class="btn btn-primary">获取信息</button>
                        </div>
                    </div>

                    <!-- Row 2 -->
                    <div class="form-item">
                        <label for="insurer">承保方</label>
                        <select id="insurer">
                            <option>平安保险</option>
                            <option>人保财险</option>
                            <option>太平洋保险</option>
                            <option>其他</option>
                        </select>
                    </div>
                    <div class="form-item">
                        <label for="license-plate">车牌号</label>
                        <input type="text" id="license-plate" placeholder="点击获取信息后自动填充">
                    </div>

                    <!-- Row 3 -->
                    <div class="form-item">
                        <label for="reporter">报案人</label>
                        <input type="text" id="reporter" placeholder="点击获取信息后自动填充">
                    </div>
                    <div class="form-item">
                        <label for="reporter-phone">报案人电话</label>
                        <input type="text" id="reporter-phone" placeholder="点击获取信息后自动填充">
                    </div>

                    <!-- Row 4 -->
                    <div class="form-item">
                        <label for="incident-time">出险时间</label>
                        <input type="datetime-local" id="incident-time" placeholder="点击获取信息后自动填充">
                    </div>
                    <div class="form-item">
                        <label for="commission-time">委托时间</label>
                        <input type="datetime-local" id="commission-time" placeholder="点击获取信息后自动填充">
                    </div>

                    <!-- Row 5 -->
                    <div class="form-item col-span-2">
                        <label for="location">作业地点</label>
                        <div class="input-group">
                            <select class="city-select"><option>选择省市区</option><option selected>广东省广州市天河区</option></select>
                            <input type="text" class="address-input" id="location" placeholder="手录详细地址">
                        </div>
                    </div>

                    <!-- Row 6 -->
                    <div class="form-item">
                        <label for="task-type">保司调派任务类型</label>
                        <select id="task-type">
                            <option>查勘+定损</option>
                            <option>人伤查勘</option>
                            <option>车物查勘</option>
                            <option>车物定损</option>
                        </select>
                    </div>
                    <div class="form-item">
                        <label for="dispatcher">调度员</label>
                        <input type="text" id="dispatcher" value="王芳 (按当前账号)" disabled>
                    </div>

                    <!-- Row 7 -->
                    <div class="form-item">
                        <label for="estimated-loss">估损金额</label>
                        <div style="position: relative;">
                            <input type="number" id="estimated-loss" placeholder="0.00" style="padding-right: 30px;">
                            <span style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #909399;">元</span>
                        </div>
                    </div>
                    <div class="form-item">
                        <label for="estimated-commission">预计佣金</label>
                        <div style="position: relative;">
                            <input type="number" id="estimated-commission" placeholder="手填" style="padding-right: 30px;">
                            <span style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #909399;">元</span>
                        </div>
                    </div>

                    <!-- Row 8 -->
                    <div class="form-item col-span-2">
                        <label for="remarks">备注</label>
                        <textarea id="remarks"></textarea>
                    </div>

                    <!-- Actions -->
                    <div class="form-actions">
                        <button type="button" id="reset-btn" class="btn btn-secondary">重置</button>
                        <a href="dispatcher_dispatch_center.html" class="btn btn-primary">手动派单</a>
                        <button type="button" id="auto-dispatch-btn" class="btn btn-secondary">自动派单</button>
                    </div>
                </form>
            </div>
        </main>
    </div>
</div>

<script src="demo_helper.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const fetchBtn = document.getElementById('fetch-case-data-btn');
        const caseNoInput = document.getElementById('case-no');
        const resetBtn = document.getElementById('reset-btn');
        const autoDispatchBtn = document.getElementById('auto-dispatch-btn');

        fetchBtn.addEventListener('click', function() {
            if (!caseNoInput.value) {
                showModal('操作提示', '请输入案件号 / 报案号！', 'warning');
                return;
            }

            this.textContent = '获取中...';
            this.disabled = true;

            setTimeout(() => {
                const mockData = {
                    licensePlate: '粤A·88888',
                    reporter: '王先生',
                    reporterPhone: '13800138000',
                    incidentTime: '2024-05-20T09:15',
                    commissionTime: '2024-05-20T09:25',
                    location: '黄埔大道西668号 赛马场内',
                    estimatedLoss: 4500,
                    insurer: '平安保险',
                    taskType: '查勘+定损'
                };

                document.getElementById('license-plate').value = mockData.licensePlate;
                document.getElementById('reporter').value = mockData.reporter;
                document.getElementById('reporter-phone').value = mockData.reporterPhone;
                document.getElementById('incident-time').value = mockData.incidentTime;
                document.getElementById('commission-time').value = mockData.commissionTime;
                document.getElementById('location').value = mockData.location;
                document.getElementById('estimated-loss').value = mockData.estimatedLoss;

                this.textContent = '获取信息';
                this.disabled = false;

                showModal('成功', '案件信息已成功获取并填充！', 'success');

            }, 800);
        });

        resetBtn.addEventListener('click', function() {
            document.getElementById('case-no').value = '';
            document.getElementById('incident-time').value = '';
            document.getElementById('license-plate').value = '';
            document.getElementById('commission-time').value = '';
            document.getElementById('reporter').value = '';
            document.getElementById('reporter-phone').value = '';
            document.querySelector('.address-input').value = '';
            document.getElementById('estimated-loss').value = '';
            document.getElementById('estimated-commission').value = '';
            document.getElementById('remarks').value = '';

            document.getElementById('insurer').selectedIndex = 0;
            document.getElementById('task-type').selectedIndex = 0;
            document.querySelector('.city-select').selectedIndex = 0;
        });

        autoDispatchBtn.addEventListener('click', function() {
            const licensePlateInput = document.getElementById('license-plate');

            if (!licensePlateInput.value) {
                showModal('操作提示', '请先获取案件信息，再进行自动派单。', 'warning');
                return;
            }

            showModal('派单成功', '根据位置与排班，已自动派单给查勘员：陈浩', 'success');
        });
    });
</script>
</body>
</html>